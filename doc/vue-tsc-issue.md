## 標題

為確保 Nuxt 3 應用程式在 Vercel 部署前型別安全，要求所有 PR/部署流程必須通過 `vue-tsc` 型別檢查。此 issue 記錄需求、執行步驟、CI/CD 整合方式與常見問題。

## 驗證流程（Step by Step）

### 1. 本地型別檢查

1. 打開終端機，切換到專案根目錄。
2. 執行：

```bash
pnpm vue-tsc --noEmit
```

3. 若無錯誤，型別檢查通過。
4. 若有錯誤，終端機會顯示錯誤訊息（如 EBtn.vue color 型別錯誤），請修正後重試。

### 2. 故意製造型別錯誤驗證

1. 編輯 `components/EBtn.vue`，將 `color` props 型別改為 `number`（原本應為 string union）。
2. 重複本地型別檢查步驟，確認 vue-tsc 報錯。
3. 修正型別錯誤後再次執行，確認錯誤消失。

### 3. CI/CD（GitHub Actions）驗證

1. push 或建立 PR 到 master 分支。
2. 前往 GitHub repo 的 Actions 頁面，找到 CI workflow。
3. 查看 Type Check (vue-tsc) 步驟，若型別錯誤則 workflow 失敗。
4. 修正型別錯誤後再次 push/PR，確認 CI 通過。

### 4. Vercel build command 驗證

1. 前往 Vercel 專案設定頁面。
2. 將 Build Command 設為：

```bash
pnpm vue-tsc --noEmit && pnpm build
```

3. 重新部署專案。
4. 若型別錯誤，Vercel build 會失敗並顯示錯誤訊息。
5. 修正型別錯誤後重新部署，確認 build 成功。

## PR checklist

- [ ] 所有 PR 必須通過 `pnpm vue-tsc --noEmit`
- [ ] CI/CD pipeline 失敗時禁止部署
- [ ] Vercel build command 加入型別檢查
- [ ] 型別錯誤修正後再 push/merge
- 部署到 Vercel 前自動執行型別檢查
- CI/CD pipeline 失敗時禁止部署

## 執行步驟

1. 安裝 `vue-tsc`（已在 devDependencies）
2. 在本地執行型別檢查：
   ```bash
   pnpm vue-tsc --noEmit
   ```
3. 在 CI/CD（如 Vercel 或 GitHub Actions）加入型別檢查步驟：
   - 於 build 前執行 `pnpm vue-tsc --noEmit`
   - 若檢查失敗則中斷 build/deploy
   - **GitHub Actions workflow 實例**：
     ```yaml
     name: CI
     on:
       push:
         branches: [master]
       pull_request:
         branches: [master]
     jobs:
       build:
         runs-on: ubuntu-latest
         steps:
           - uses: actions/checkout@v3
           - uses: pnpm/action-setup@v2
             with:
               version: 9
           - name: Install dependencies
             run: pnpm install
           - name: Type Check (vue-tsc)
             run: pnpm vue-tsc --noEmit
           - name: Build
             run: pnpm build
     ```
   - **說明**：
     - 每次 push 或 PR 觸發 CI，先安裝依賴、執行型別檢查，通過後才進行 build。
     - 若 `pnpm vue-tsc --noEmit` 有型別錯誤，CI 會失敗，build/deploy 不會執行。
     - 可依專案需求調整 branch 或 workflow 名稱。

## Vercel CI/CD 整合

- 可在 Vercel 專案設定 `Build Command` 前加上型別檢查：
  ```bash
  pnpm vue-tsc --noEmit && pnpm build
  ```
- 或在 GitHub Actions workflow 加入：
  ```yaml
  - name: Type Check
    run: pnpm vue-tsc --noEmit
  ```

## 常見問題

- 型別錯誤導致 build 失敗：請修正所有 TS/props/emit 型別
- vue-tsc 未安裝：請確認 `devDependencies` 有 `vue-tsc`
- Vercel 預設 build 指令未加型別檢查：請手動修改 build command

## 參考文件

- [vue-tsc 官方文件](https://github.com/vuejs/vue-tsc)
- [Nuxt 3 型別安全最佳實踐](https://nuxt.com/docs/guide/concepts/typescript)

## PR checklist

- [ ] 所有 PR 必須通過 `pnpm vue-tsc --noEmit`
- [ ] CI/CD pipeline 失敗時禁止部署
- [ ] Vercel build command 加入型別檢查
- [ ] 型別錯誤修正後再 push/merge

---

Generated by dev-assistant for vue-tsc type check enforcement.
